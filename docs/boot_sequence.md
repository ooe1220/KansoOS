# 簡素OS起動の流れ
電源投入 → BIOS → boot/mbr.asm → boot/vbr.asm → kernel/switch32.asm → kernel/kernel.c
kernel.cからそれぞれの関数を呼び出す。


# HDD上の各プログラムの配置
| ファイル | バイナリ | セクタ位置 | トラック | メモリ読み込み先 |
|----------|----------|------------|----------|------------------|
| boot/mbr.asm | mbr.bin | 0セクタ | 第0トラック | 0x7C00 |
| boot/vbr.asm | vbr.bin | 63セクタ | 第1トラック | 0x7C00 |
| kernel/* | kernel.bin | 112セクタ | 第2トラック | 0x8000 |

* セクタサイズ: 512バイト
* セクタ64-111: 未使用領域
* セクタ112以降: カーネル領域

# MBR（Master Boot Record）

## 概要
BIOSから最初に呼び出されるプログラム。

## 役割
- BIOSから最初に実行されるプログラム
- パーティション表（最大4つのパーティション情報）を保持
- VBRをHDDからメモリへ読み込み
- 制御をVBRへ移行するための`jmp`命令を実行

## 簡素OSでの実装詳細
1. **メモリ配置**
   - BIOSによりメモリ`0x7C00`に読み込まれる
   
2. **VBR読み込み時の処理**
   - VBRをMBRと同じメモリアドレス（`0x7C00`）に読み込む必要があるため
   - まずMBR自身を`0x0600`へ退避
   - その後、`0x0600`へ制御を移行
   - 最後にVBRを`0x7C00`へ読み込み、制御を移行

---

# VBR（Volume Boot Record）

## 概要
パーティションの最初のセクタに配置されるプログラム。

## 構成
1. **ジャンプ命令**（必須）
   - 先頭3バイトに`jmp start`命令を配置
   - BPB領域を跳ばし、実行可能コードへ移動するため
   - 省略すると、BPBデータが機械語として誤実行される

2. **BPB（BIOS Parameter Block）**
   - ファイルシステムの基本情報を含む
   - 主な設定値：
     - セクタの大きさ
     - クラスタの大きさ
     - FAT情報
     - 予約セクタ数
     - その他のファイルシステム設定値

3. **実行可能コード**
   - kernel.binの読み込みと実行

## メモリ配置
- MBRによりメモリ`0x7C00`へ読み込まれる
- これにより、MBRとVBRは同じメモリアドレスで実行される
